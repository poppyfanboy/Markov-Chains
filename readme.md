# чего

## оглавление

- [чего](#чего)
  - [оглавление](#оглавление)
  - [todo](#todo)
    - [минимально рабочая штука](#минимально-рабочая-штука)
    - [потом](#потом)
  - [верхний блок](#верхний-блок)
  - [список источников](#список-источников)
    - [фильтры](#фильтры)
    - [ограничение на количество слов/символов](#ограничение-на-количество-словсимволов)
    - [вероятность источника](#вероятность-источника)
    - [произвольный сайт в качестве источника](#произвольный-сайт-в-качестве-источника)

## todo

### минимально рабочая штука

1. ~~Добавить кнопку удаления фильтра~~

2. ~~Выделить штуку для ввода длины (в словах / символах / _предложениях_) в отдельный компонент. Вместо коллбэков исползовать mobx. Сделать, чтобы поле для ввода чисел вело себя более адекватно, добавить возможность вставить "k" в конец. Думаю, надо сделать так, чтобы всё же модель (`TextLength`) хранила введённое количество единиц как сырую строку и лениво парсила её по надобности. Возвращать `null`, если не получается распарсить.~~

3. ~~Сделать модель списка источников. Чтобы она следила за изменениями моделей источников и апдейтила их вероятность КАК-НИБУДЬ. Реализовать кнопочки очистки текста и удаления источника. При добавлении нового источника добавлять его с нулевой вероятностью, чтобы не мешать остальным источникам?~~

4. Доделать модель приложения и связать её с компонентом. Возможность задать размер выходного текста в символах только, если генерация по N-граммам. Аналогично, максимальная длина источника задаётся в символах только, если генерируем по N-граммам. Иначе из опций только слова и предложения. То есть надо в компонент с выбором длины текста передавать список возможных опций для выбора. Если он меняется, то выбирать любую доступную опцию на замену. Убирать кнопку выравнивания вероятностей, если добавлено меньше двух источников.

5. Пофиксить названия CSS классов, проверить, что они корректные.

6. Посмотреть, как querySelector относится к всякому мусору в строке, которую ты ему передаёшь.

7. Сделать имитацию работы при нажатии на генерацию текста. Информацию о том, какие фильтры выбраны и что должно было бы происходить сейчас.

8. Сделать модель дваче-постов, реализовать логику фильтров для них.

9. Сделать доставание постов через дваче апи, возможно, обернуть это в какую-нибудь абстракцию, чтобы можно было, например, реализовать её для любой имиджборды или, например, архивача.

10. Написать штуку для генерации текста по словам и по N-граммам. Если пытаешься сгенерировать по частям речи или используешь селектор для произвольной ссылки, пока что выводить ошибку, можно прямо в поле для вывода текста.

### потом

1. Возможность вставлять произвольные ссылки и указывать селекторы. Если селектор не указан, как-нибудь искать элемент с максимальным количеством видимого текста (и пробовать найти по классу этого элемента другие такие же элементы с текстом), либо восползоваться [готовым решением](https://www.npmjs.com/package/article-parser).

2. Возможность генерации по частям речи.

3. Более-менее адекватный CSS.

4. Адаптивный CSS, aria атрибуты.

## верхний блок

Когда нажимаешь на "по N-граммам", выводится дополнительная штука для выбора размера N-грамм.

Наверное, неправильно брать первую попавшуюся ссылку в введённом тексте, потому что текст сам по себе может содержать ссылки. Лучше, чтобы пользователь сам выбрал, что конкретно он хочет: достать текст по ссылке или использовать то, что введено как источник.

Ссылка на двач" и "произвольная ссылка" должны быть взаимоисключающими.

Ещё почти забыл про размер текста на выходе. Нужно, чтобы можно было указать размер в словах / символах. Для генерации по словам сделать символьный размер недоступной опцией, по причине это тупость какая-то.

## список источников

### фильтры

Должен автоматически определять, искать по всей доске или по треду. Если по треду, то по умолчанию берёт просто все посты из треда, но можно нажать на "добавить фильтры" где есть:

- поиск по имени (без/с регекспом)

- поиск по трипкоду (тоже можно с регекспом, я думаю)

- поиск по метке опа, только для поиска по треду

- "содержит слова" или есть хотя бы одно слово, соответствующее регекспу?

Можно попробовать сделать так: можно добавлять любое количество однотипных фильтров и между фильтрами можно вставить "AND" или "OR". И чтобы можно было делать отрицание для фильтров. Так можно будет в теории записать что угодно в ДНФ. Не лучший вариант, нет скобок, но самый простой в реализации и в использовании тоже, я думаю.

И ещё, я думаю, должна быть кнопочка, чтобы выбрать, пользователь хочет применить сразу все фильтры или чтобы прокнулся хотя бы один. Ну то есть, кнопка, которая меняет всё на "AND" или всё на "OR".

### ограничение на количество слов/символов

Если поиск по доске, то обязательно надо добавить хотя бы какой-нибудь фильтр? А если фильтр такой, что для него подходят все посты? В тредах текста не то чтобы может быть супер много, но текст со всей доски сохранять - это уже сомнительно. Возможно, стоит добавить возможность выбрать максимальное количество символов, которые надо съесть, ну там по умолчанию какое-то разумное количество должно стоять. И чтобы можно было выбрать единицу измерения: символы / тысячи символов / слова / тысячи слов. Тысячи просто как k/к после числа реализовать, наверное.

### вероятность источника

Если указан ровно один источник, то не показывать ползунок с выбором вероятности. Если несколько источников, то ползунки должны апдейтиться так, чтобы суммарная вероятность оставалась 1.

### произвольный сайт в качестве источника

Если указывается произвольный сайт, то сделать дополнительно возможность написать querySelector (которому может соответствовать несколько дом элементов), откуда доставать текст. Если querySelector не указан, то смотреть, в каком дом элементе максимальное количество текста?
